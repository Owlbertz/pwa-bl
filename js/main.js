"serviceWorker"in navigator&&navigator.serviceWorker.register("./worker.js").then(function(e){}).catch(function(e){console.warn("Error registering Service Worker:",e)});var isOnline=location.hash.indexOf("online")!==-1,isOffline=location.hash.indexOf("offline")!==-1,useLocal=location.hash.indexOf("local")!==-1,App=function(){var e=function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){var r=e.indexOf("http")===-1;r||200===o.status?r?setTimeout(function(){t(o.responseText)},2e3):t(o.responseText):(console.error("Failed to get:",e),n(new Error(o.statusText)))},o.onerror=function(){App.showOffline(),console.error("Failed to get:",e),n(new Error("Offline"))},o.send()})},t=[],n=function(e){return"string"==typeof e&&(e=[e]),new Promise(function(n,o){var r=0,i=function(){++r===e.length&&(console.log("Finished loading all files!"),n())};e.forEach(function(e){if(t.indexOf(e)>-1)return void i();var n=e.indexOf(".js")!==-1?"js":"css";if("js"===n){var o=document.createElement("script");o.setAttribute("src",e),o.onload=i,"undefined"!=typeof o&&document.getElementsByTagName("body")[0].appendChild(o)}else if("css"===n){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),o.onload=i,"undefined"!=typeof o&&document.getElementsByTagName("body")[0].appendChild(o)}})})},o=function(e){return new Promise(function(t,n){document.querySelectorAll(".result:not(.template)").forEach(function(e){e.remove()});var o=document.querySelector(".result.template"),r=document.querySelector(".results");e.forEach(function(e){var n=o.cloneNode(!0),i=n.querySelector(".more-container"),a=i.querySelector(".goals");predictionsContainer=i.querySelector(".predictions"),showMoreButton=n.querySelector(".shore-more-button"),n.classList.remove("template"),n.setAttribute("data-match-id",e.MatchID),n.querySelector(".team1-name").textContent=e.Team1.TeamName,n.querySelector(".team2-name").textContent=e.Team2.TeamName,n.querySelector(".team1-icon").setAttribute("src",e.Team1.TeamIconUrl),n.querySelector(".team1-icon").setAttribute("alt",e.Team1.TeamName+" icon"),n.querySelector(".team1-icon").addEventListener("load",function(){this.classList.add("loaded")}),n.querySelector(".team2-icon").setAttribute("src",e.Team2.TeamIconUrl),n.querySelector(".team2-icon").setAttribute("alt",e.Team2.TeamName+" icon"),n.querySelector(".team2-icon").addEventListener("load",function(){this.classList.add("loaded")});var s=new Date(e.MatchDateTimeUTC),c=App.Util.dateParser(s);n.querySelector(".time").textContent=c;var l="more-container-"+e.MatchID;if(i.setAttribute("id",l),showMoreButton.setAttribute("aria-controls",l),showMoreButton.addEventListener("click",function(e){var t="true"===this.getAttribute("aria-expanded");t?(this.setAttribute("aria-expanded",!1),i.classList.remove("open"),this.setAttribute("title","Show additional information")):(this.setAttribute("aria-expanded",!0),i.classList.add("open"),this.setAttribute("title","Hide additional information"))}),e.MatchIsFinished){n.classList.add("finished");var d=2===e.MatchResults[0].ResultOrderID?0:1;n.querySelector(".points-team1").textContent=e.MatchResults[d].PointsTeam1,n.querySelector(".points-team2").textContent=e.MatchResults[d].PointsTeam2;var u=0,f=0;e.Goals.forEach(function(t){var n;t.ScoreTeam1>u?(n=1,u=t.ScoreTeam1):(n=2,f=t.ScoreTeam2);var o=a.querySelector("li.template").cloneNode(!0);o.classList.add("goal-team-"+n),o.classList.remove("template"),o.querySelector(".goal-scorer").innerHTML=t.GoalGetterName+'<span class="visuallyhidden">for team: '+e["Team"+n].TeamName+"</span>",o.querySelector(".goal-time").textContent=t.MatchMinute,a.querySelector("ul").appendChild(o)})}else new Date(e.MatchDateTime)<new Date?n.classList.add("ongoing"):(n.classList.add("not-started"),a.classList.add("hide"));r.appendChild(n),t()})})};return{init:function(){n("js/util.js").then(function(){window.addEventListener("online",function(e){App.hideOffline(),App.loadResults()},!1),window.addEventListener("offline",function(e){App.showOffline()},!1),isOnline||navigator.onLine?App.loadResults():App.showOffline(),App.Navigation&&App.Navigation.render(),App.Features.predictions?n("js/predictions.js").then(function(){App.Predictions.render()}):console.warn("Predictions are not available.")})},loadResults:function(){App.showLoading();var t=this.Navigation.getSelectedWeek(),n=useLocal?"http://localhost/bl/data/data-bl1-2016-"+t+".json":"http://www.openligadb.de/api/getmatchdata/bl1/2016/"+t;e(n).then(function(e){return console.log(App.Util.resultParser(e)),o(App.Util.resultParser(e))}).then(function(){App.hideLoading()})},showOffline:function(){this.offline=!0,e("offline.html").then(function(e){var t=document.createElement("div");t.setAttribute("id","offline-container"),t.innerHTML=e,document.querySelector("#container").appendChild(t),document.querySelector("body").classList.add("offline")})},hideOffline:function(){this.offline=!0,document.querySelector("#offline-container").remove(),document.querySelector("body").classList.remove("offline")},showLoading:function(){this.loading=!0,document.querySelector("body").classList.add("loading")},hideLoading:function(){this.loading=!1,document.querySelector("body").classList.remove("loading")},Features:function(){return{predictions:function(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}()}}(),Navigation:function(){var e=new Date;e.setMinutes(0),e.setHours(0),e.setSeconds(0),e.setMilliseconds(0);var t=new Date("2016-08-25T00:00:00");return msPerWeek=6048e5,weeksSinceSeasonStart=1+Math.floor((e-t)/msPerWeek),rendered=!1,regex=/#!\d{1,2}/,_updateLocation=function(e){location.hash.match(regex)?location.hash=location.hash.replace(regex,"#!"+e):location.hash="#!"+e+location.hash},_getSelectedWeekFromLocation=function(){var e=location.hash.match(regex);if(!e)return null;try{return parseInt(e[0].replace("#!",""))}catch(e){return console.error("Unable to parse week from URL: ",e),null}},selectedWeek=_getSelectedWeekFromLocation()||weeksSinceSeasonStart,{getWeeksSinceSeasonStart:function(){return weeksSinceSeasonStart},getSelectedWeek:function(){return selectedWeek},goToNextWeek:function(){selectedWeek++,_updateLocation(selectedWeek)},goToPrevWeek:function(){selectedWeek--,_updateLocation(selectedWeek)},isPrevButtonActive:function(){return selectedWeek>1},isNextButtonActive:function(){return selectedWeek<34},render:function(){var e=document.querySelector("nav"),t=e.querySelector(".prev"),o=e.querySelector(".next");if(this.isPrevButtonActive()?t.removeAttribute("disabled"):t.setAttribute("disabled",!0),this.isNextButtonActive()?o.removeAttribute("disabled"):o.setAttribute("disabled",!0),e.querySelector(".current-week").textContent=this.getSelectedWeek(),!rendered){var r=this,i=function(e){App.loading||App.offline||!r.isNextButtonActive||(r.goToNextWeek(),r.render(),App.loadResults())},a=function(e){App.loading||App.offline||!r.isPrevButtonActive||(r.goToPrevWeek(),r.render(),App.loadResults())};"ontouchstart"in window&&n("js/app.js").then(function(){document.addEventListener("swipeleft",i),document.addEventListener("swiperight",a)}),o.addEventListener("click",i),t.addEventListener("click",a),rendered=!0}}}}()}}();App.init();